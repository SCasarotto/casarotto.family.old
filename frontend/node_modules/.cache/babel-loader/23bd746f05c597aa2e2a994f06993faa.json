{"ast":null,"code":"import validate from 'validate.js';\nimport firebase from 'firebase/app';\nimport 'firebase/firestore';\nexport const saveRSVP = async data => {\n  const {\n    uid,\n    name,\n    foodChoice,\n    comment,\n    status,\n    popupFunctions\n  } = data;\n  const {\n    showNetworkActivity,\n    hideNetworkActivity,\n    showAlert\n  } = popupFunctions;\n  const validatorConstraints = {\n    name: {\n      presence: {\n        allowEmpty: false\n      }\n    },\n    foodChoice: {\n      presence: {\n        allowEmpty: false\n      }\n    },\n    status: {\n      presence: {\n        allowEmpty: false\n      }\n    }\n  };\n  const validationResponse = validate(data, validatorConstraints);\n\n  if (validationResponse) {\n    const valuesArray = Object.values(validationResponse);\n    const firstError = valuesArray[0];\n    const firstErrorMessage = firstError[0];\n    showAlert({\n      title: 'Error',\n      message: firstErrorMessage\n    });\n    throw new Error(firstErrorMessage);\n  }\n\n  try {\n    showNetworkActivity('Saving RSVP...');\n    await firebase.firestore().collection('WeddingRSVPs').doc(uid).update({\n      name,\n      foodChoice,\n      comment,\n      status\n    });\n    hideNetworkActivity();\n    showAlert({\n      title: 'Success',\n      message: 'RSVP saved'\n    });\n    return;\n  } catch (e) {\n    console.log(e);\n    showAlert({\n      title: 'Error',\n      message: 'Error saving RSVP'\n    });\n    throw new Error(e);\n  }\n};","map":{"version":3,"sources":["/Users/stuartcasarotto/Documents/family-website/src/pages/admin/RSVPs/EditRSVPPopup/requests.ts"],"names":["validate","firebase","saveRSVP","data","uid","name","foodChoice","comment","status","popupFunctions","showNetworkActivity","hideNetworkActivity","showAlert","validatorConstraints","presence","allowEmpty","validationResponse","valuesArray","Object","values","firstError","firstErrorMessage","title","message","Error","firestore","collection","doc","update","e","console","log"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,aAArB;AACA,OAAOC,QAAP,MAAqB,cAArB;AACA,OAAO,oBAAP;AAWA,OAAO,MAAMC,QAAQ,GAAG,MAAOC,IAAP,IAAsB;AAC7C,QAAM;AAAEC,IAAAA,GAAF;AAAOC,IAAAA,IAAP;AAAaC,IAAAA,UAAb;AAAyBC,IAAAA,OAAzB;AAAkCC,IAAAA,MAAlC;AAA0CC,IAAAA;AAA1C,MAA6DN,IAAnE;AACA,QAAM;AAAEO,IAAAA,mBAAF;AAAuBC,IAAAA,mBAAvB;AAA4CC,IAAAA;AAA5C,MAA0DH,cAAhE;AAEA,QAAMI,oBAA4C,GAAG;AACpDR,IAAAA,IAAI,EAAE;AACLS,MAAAA,QAAQ,EAAE;AACTC,QAAAA,UAAU,EAAE;AADH;AADL,KAD8C;AAMpDT,IAAAA,UAAU,EAAE;AACXQ,MAAAA,QAAQ,EAAE;AACTC,QAAAA,UAAU,EAAE;AADH;AADC,KANwC;AAWpDP,IAAAA,MAAM,EAAE;AACPM,MAAAA,QAAQ,EAAE;AACTC,QAAAA,UAAU,EAAE;AADH;AADH;AAX4C,GAArD;AAiBA,QAAMC,kBAAkB,GAAGhB,QAAQ,CAACG,IAAD,EAAOU,oBAAP,CAAnC;;AACA,MAAIG,kBAAJ,EAAwB;AACvB,UAAMC,WAAoB,GAAGC,MAAM,CAACC,MAAP,CAAcH,kBAAd,CAA7B;AACA,UAAMI,UAAiB,GAAGH,WAAW,CAAC,CAAD,CAArC;AACA,UAAMI,iBAAyB,GAAGD,UAAU,CAAC,CAAD,CAA5C;AACAR,IAAAA,SAAS,CAAC;AACTU,MAAAA,KAAK,EAAE,OADE;AAETC,MAAAA,OAAO,EAAEF;AAFA,KAAD,CAAT;AAIA,UAAM,IAAIG,KAAJ,CAAUH,iBAAV,CAAN;AACA;;AAED,MAAI;AACHX,IAAAA,mBAAmB,CAAC,gBAAD,CAAnB;AACA,UAAMT,QAAQ,CACZwB,SADI,GAEJC,UAFI,CAEO,cAFP,EAGJC,GAHI,CAGAvB,GAHA,EAIJwB,MAJI,CAIG;AAAEvB,MAAAA,IAAF;AAAQC,MAAAA,UAAR;AAAoBC,MAAAA,OAApB;AAA6BC,MAAAA;AAA7B,KAJH,CAAN;AAMAG,IAAAA,mBAAmB;AACnBC,IAAAA,SAAS,CAAC;AACTU,MAAAA,KAAK,EAAE,SADE;AAETC,MAAAA,OAAO,EAAE;AAFA,KAAD,CAAT;AAIA;AACA,GAdD,CAcE,OAAOM,CAAP,EAAU;AACXC,IAAAA,OAAO,CAACC,GAAR,CAAYF,CAAZ;AACAjB,IAAAA,SAAS,CAAC;AACTU,MAAAA,KAAK,EAAE,OADE;AAETC,MAAAA,OAAO,EAAE;AAFA,KAAD,CAAT;AAIA,UAAM,IAAIC,KAAJ,CAAUK,CAAV,CAAN;AACA;AACD,CAvDM","sourcesContent":["import validate from 'validate.js'\nimport firebase from 'firebase/app'\nimport 'firebase/firestore'\nimport { useTEPopupsFunctions } from 'react-tec'\n\ninterface Data {\n\tuid: string\n\tname: string\n\tfoodChoice?: string\n\tcomment: string\n\tstatus?: number\n\tpopupFunctions: useTEPopupsFunctions\n}\nexport const saveRSVP = async (data: Data) => {\n\tconst { uid, name, foodChoice, comment, status, popupFunctions } = data\n\tconst { showNetworkActivity, hideNetworkActivity, showAlert } = popupFunctions\n\n\tconst validatorConstraints: { [key: string]: any } = {\n\t\tname: {\n\t\t\tpresence: {\n\t\t\t\tallowEmpty: false,\n\t\t\t},\n\t\t},\n\t\tfoodChoice: {\n\t\t\tpresence: {\n\t\t\t\tallowEmpty: false,\n\t\t\t},\n\t\t},\n\t\tstatus: {\n\t\t\tpresence: {\n\t\t\t\tallowEmpty: false,\n\t\t\t},\n\t\t},\n\t}\n\tconst validationResponse = validate(data, validatorConstraints)\n\tif (validationResponse) {\n\t\tconst valuesArray: any[][] = Object.values(validationResponse)\n\t\tconst firstError: any[] = valuesArray[0]\n\t\tconst firstErrorMessage: string = firstError[0]\n\t\tshowAlert({\n\t\t\ttitle: 'Error',\n\t\t\tmessage: firstErrorMessage,\n\t\t})\n\t\tthrow new Error(firstErrorMessage)\n\t}\n\n\ttry {\n\t\tshowNetworkActivity('Saving RSVP...')\n\t\tawait firebase\n\t\t\t.firestore()\n\t\t\t.collection('WeddingRSVPs')\n\t\t\t.doc(uid)\n\t\t\t.update({ name, foodChoice, comment, status })\n\n\t\thideNetworkActivity()\n\t\tshowAlert({\n\t\t\ttitle: 'Success',\n\t\t\tmessage: 'RSVP saved',\n\t\t})\n\t\treturn\n\t} catch (e) {\n\t\tconsole.log(e)\n\t\tshowAlert({\n\t\t\ttitle: 'Error',\n\t\t\tmessage: 'Error saving RSVP',\n\t\t})\n\t\tthrow new Error(e)\n\t}\n}\n"]},"metadata":{},"sourceType":"module"}