{"ast":null,"code":"import _regeneratorRuntime from\"/Users/stuartcasarotto/Documents/family-website/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/stuartcasarotto/Documents/family-website/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import validate from'validate.js';import firebase from'firebase/app';import'firebase/firestore';export var saveRSVP=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var uid,name,foodChoice,comment,status,popupFunctions,showNetworkActivity,hideNetworkActivity,showAlert,validatorConstraints,validationResponse,valuesArray,firstError,firstErrorMessage;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:uid=data.uid,name=data.name,foodChoice=data.foodChoice,comment=data.comment,status=data.status,popupFunctions=data.popupFunctions;showNetworkActivity=popupFunctions.showNetworkActivity,hideNetworkActivity=popupFunctions.hideNetworkActivity,showAlert=popupFunctions.showAlert;validatorConstraints={name:{presence:{allowEmpty:false}},foodChoice:{presence:{allowEmpty:false}},status:{presence:{allowEmpty:false}}};validationResponse=validate(data,validatorConstraints);if(!validationResponse){_context.next=10;break;}valuesArray=Object.values(validationResponse);firstError=valuesArray[0];firstErrorMessage=firstError[0];showAlert({title:'Error',message:firstErrorMessage});throw new Error(firstErrorMessage);case 10:_context.prev=10;showNetworkActivity('Saving RSVP...');_context.next=14;return firebase.firestore().collection('WeddingRSVPs').doc(uid).update({name:name,foodChoice:foodChoice,comment:comment,status:status});case 14:hideNetworkActivity();showAlert({title:'Success',message:'RSVP saved'});return _context.abrupt(\"return\");case 19:_context.prev=19;_context.t0=_context[\"catch\"](10);console.log(_context.t0);showAlert({title:'Error',message:'Error saving RSVP'});throw new Error(_context.t0);case 24:case\"end\":return _context.stop();}}},_callee,null,[[10,19]]);}));return function saveRSVP(_x){return _ref.apply(this,arguments);};}();","map":{"version":3,"sources":["/Users/stuartcasarotto/Documents/family-website/frontend/src/pages/admin/RSVPs/EditRSVPPopup/requests.ts"],"names":["validate","firebase","saveRSVP","data","uid","name","foodChoice","comment","status","popupFunctions","showNetworkActivity","hideNetworkActivity","showAlert","validatorConstraints","presence","allowEmpty","validationResponse","valuesArray","Object","values","firstError","firstErrorMessage","title","message","Error","firestore","collection","doc","update","console","log"],"mappings":"2VAAA,MAAOA,CAAAA,QAAP,KAAqB,aAArB,CACA,MAAOC,CAAAA,QAAP,KAAqB,cAArB,CACA,MAAO,oBAAP,CAWA,MAAO,IAAMC,CAAAA,QAAQ,0FAAG,iBAAOC,IAAP,2SACfC,GADe,CAC4CD,IAD5C,CACfC,GADe,CACVC,IADU,CAC4CF,IAD5C,CACVE,IADU,CACJC,UADI,CAC4CH,IAD5C,CACJG,UADI,CACQC,OADR,CAC4CJ,IAD5C,CACQI,OADR,CACiBC,MADjB,CAC4CL,IAD5C,CACiBK,MADjB,CACyBC,cADzB,CAC4CN,IAD5C,CACyBM,cADzB,CAEfC,mBAFe,CAEyCD,cAFzC,CAEfC,mBAFe,CAEMC,mBAFN,CAEyCF,cAFzC,CAEME,mBAFN,CAE2BC,SAF3B,CAEyCH,cAFzC,CAE2BG,SAF3B,CAIjBC,oBAJiB,CAI8B,CACpDR,IAAI,CAAE,CACLS,QAAQ,CAAE,CACTC,UAAU,CAAE,KADH,CADL,CAD8C,CAMpDT,UAAU,CAAE,CACXQ,QAAQ,CAAE,CACTC,UAAU,CAAE,KADH,CADC,CANwC,CAWpDP,MAAM,CAAE,CACPM,QAAQ,CAAE,CACTC,UAAU,CAAE,KADH,CADH,CAX4C,CAJ9B,CAqBjBC,kBArBiB,CAqBIhB,QAAQ,CAACG,IAAD,CAAOU,oBAAP,CArBZ,KAsBnBG,kBAtBmB,0BAuBhBC,WAvBgB,CAuBOC,MAAM,CAACC,MAAP,CAAcH,kBAAd,CAvBP,CAwBhBI,UAxBgB,CAwBIH,WAAW,CAAC,CAAD,CAxBf,CAyBhBI,iBAzBgB,CAyBYD,UAAU,CAAC,CAAD,CAzBtB,CA0BtBR,SAAS,CAAC,CACTU,KAAK,CAAE,OADE,CAETC,OAAO,CAAEF,iBAFA,CAAD,CAAT,CA1BsB,KA8BhB,IAAIG,CAAAA,KAAJ,CAAUH,iBAAV,CA9BgB,0BAkCtBX,mBAAmB,CAAC,gBAAD,CAAnB,CAlCsB,uBAmChBT,CAAAA,QAAQ,CACZwB,SADI,GAEJC,UAFI,CAEO,cAFP,EAGJC,GAHI,CAGAvB,GAHA,EAIJwB,MAJI,CAIG,CAAEvB,IAAI,CAAJA,IAAF,CAAQC,UAAU,CAAVA,UAAR,CAAoBC,OAAO,CAAPA,OAApB,CAA6BC,MAAM,CAANA,MAA7B,CAJH,CAnCgB,SAyCtBG,mBAAmB,GACnBC,SAAS,CAAC,CACTU,KAAK,CAAE,SADE,CAETC,OAAO,CAAE,YAFA,CAAD,CAAT,CA1CsB,4FAgDtBM,OAAO,CAACC,GAAR,cACAlB,SAAS,CAAC,CACTU,KAAK,CAAE,OADE,CAETC,OAAO,CAAE,mBAFA,CAAD,CAAT,CAjDsB,KAqDhB,IAAIC,CAAAA,KAAJ,aArDgB,uEAAH,kBAARtB,CAAAA,QAAQ,4CAAd","sourcesContent":["import validate from 'validate.js'\nimport firebase from 'firebase/app'\nimport 'firebase/firestore'\nimport { useTEPopupsFunctions } from 'react-tec'\n\ninterface Data {\n\tuid: string\n\tname: string\n\tfoodChoice?: string\n\tcomment: string\n\tstatus?: number\n\tpopupFunctions: useTEPopupsFunctions\n}\nexport const saveRSVP = async (data: Data) => {\n\tconst { uid, name, foodChoice, comment, status, popupFunctions } = data\n\tconst { showNetworkActivity, hideNetworkActivity, showAlert } = popupFunctions\n\n\tconst validatorConstraints: { [key: string]: any } = {\n\t\tname: {\n\t\t\tpresence: {\n\t\t\t\tallowEmpty: false,\n\t\t\t},\n\t\t},\n\t\tfoodChoice: {\n\t\t\tpresence: {\n\t\t\t\tallowEmpty: false,\n\t\t\t},\n\t\t},\n\t\tstatus: {\n\t\t\tpresence: {\n\t\t\t\tallowEmpty: false,\n\t\t\t},\n\t\t},\n\t}\n\tconst validationResponse = validate(data, validatorConstraints)\n\tif (validationResponse) {\n\t\tconst valuesArray: any[][] = Object.values(validationResponse)\n\t\tconst firstError: any[] = valuesArray[0]\n\t\tconst firstErrorMessage: string = firstError[0]\n\t\tshowAlert({\n\t\t\ttitle: 'Error',\n\t\t\tmessage: firstErrorMessage,\n\t\t})\n\t\tthrow new Error(firstErrorMessage)\n\t}\n\n\ttry {\n\t\tshowNetworkActivity('Saving RSVP...')\n\t\tawait firebase\n\t\t\t.firestore()\n\t\t\t.collection('WeddingRSVPs')\n\t\t\t.doc(uid)\n\t\t\t.update({ name, foodChoice, comment, status })\n\n\t\thideNetworkActivity()\n\t\tshowAlert({\n\t\t\ttitle: 'Success',\n\t\t\tmessage: 'RSVP saved',\n\t\t})\n\t\treturn\n\t} catch (e) {\n\t\tconsole.log(e)\n\t\tshowAlert({\n\t\t\ttitle: 'Error',\n\t\t\tmessage: 'Error saving RSVP',\n\t\t})\n\t\tthrow new Error(e)\n\t}\n}\n"]},"metadata":{},"sourceType":"module"}