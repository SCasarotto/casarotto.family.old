{"ast":null,"code":"import _regeneratorRuntime from\"/Users/stuartcasarotto/Documents/family-website/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/stuartcasarotto/Documents/family-website/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import validate from'validate.js';import firebase from'firebase/app';import'firebase/firestore';export var saveMessage=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var uid,message,showMessage,popupFunctions,showNetworkActivity,hideNetworkActivity,showAlert,validatorConstraints,validationResponse,valuesArray,firstError,firstErrorMessage;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:uid=data.uid,message=data.message,showMessage=data.showMessage,popupFunctions=data.popupFunctions;showNetworkActivity=popupFunctions.showNetworkActivity,hideNetworkActivity=popupFunctions.hideNetworkActivity,showAlert=popupFunctions.showAlert;validatorConstraints={message:{presence:{allowEmpty:false}},showMessage:{presence:{allowEmpty:false}}};validationResponse=validate(data,validatorConstraints);if(!validationResponse){_context.next=10;break;}valuesArray=Object.values(validationResponse);firstError=valuesArray[0];firstErrorMessage=firstError[0];showAlert({title:'Error',message:firstErrorMessage});throw new Error(firstErrorMessage);case 10:_context.prev=10;showNetworkActivity('Saving Message...');_context.next=14;return firebase.firestore().collection('WeddingMessages').doc(uid).update({message:message,showMessage:showMessage==='Displayed publicly on the website.'});case 14:hideNetworkActivity();showAlert({title:'Success',message:'Message saved'});return _context.abrupt(\"return\");case 19:_context.prev=19;_context.t0=_context[\"catch\"](10);console.log(_context.t0);showAlert({title:'Error',message:'Error saving message'});throw new Error(_context.t0);case 24:case\"end\":return _context.stop();}}},_callee,null,[[10,19]]);}));return function saveMessage(_x){return _ref.apply(this,arguments);};}();","map":{"version":3,"sources":["/Users/stuartcasarotto/Documents/family-website/src/pages/admin/Messages/EditMessagePopup/requests.ts"],"names":["validate","firebase","saveMessage","data","uid","message","showMessage","popupFunctions","showNetworkActivity","hideNetworkActivity","showAlert","validatorConstraints","presence","allowEmpty","validationResponse","valuesArray","Object","values","firstError","firstErrorMessage","title","Error","firestore","collection","doc","update","console","log"],"mappings":"iQAAA,MAAOA,CAAAA,QAAP,KAAqB,aAArB,CACA,MAAOC,CAAAA,QAAP,KAAqB,cAArB,CACA,MAAO,oBAAP,CASA,MAAO,IAAMC,CAAAA,WAAW,0FAAG,iBAAOC,IAAP,gSAClBC,GADkB,CAC4BD,IAD5B,CAClBC,GADkB,CACbC,OADa,CAC4BF,IAD5B,CACbE,OADa,CACJC,WADI,CAC4BH,IAD5B,CACJG,WADI,CACSC,cADT,CAC4BJ,IAD5B,CACSI,cADT,CAElBC,mBAFkB,CAEsCD,cAFtC,CAElBC,mBAFkB,CAEGC,mBAFH,CAEsCF,cAFtC,CAEGE,mBAFH,CAEwBC,SAFxB,CAEsCH,cAFtC,CAEwBG,SAFxB,CAIpBC,oBAJoB,CAI2B,CACpDN,OAAO,CAAE,CACRO,QAAQ,CAAE,CACTC,UAAU,CAAE,KADH,CADF,CAD2C,CAMpDP,WAAW,CAAE,CACZM,QAAQ,CAAE,CACTC,UAAU,CAAE,KADH,CADE,CANuC,CAJ3B,CAgBpBC,kBAhBoB,CAgBCd,QAAQ,CAACG,IAAD,CAAOQ,oBAAP,CAhBT,KAiBtBG,kBAjBsB,0BAkBnBC,WAlBmB,CAkBIC,MAAM,CAACC,MAAP,CAAcH,kBAAd,CAlBJ,CAmBnBI,UAnBmB,CAmBCH,WAAW,CAAC,CAAD,CAnBZ,CAoBnBI,iBApBmB,CAoBSD,UAAU,CAAC,CAAD,CApBnB,CAqBzBR,SAAS,CAAC,CACTU,KAAK,CAAE,OADE,CAETf,OAAO,CAAEc,iBAFA,CAAD,CAAT,CArByB,KAyBnB,IAAIE,CAAAA,KAAJ,CAAUF,iBAAV,CAzBmB,0BA6BzBX,mBAAmB,CAAC,mBAAD,CAAnB,CA7ByB,uBA8BnBP,CAAAA,QAAQ,CACZqB,SADI,GAEJC,UAFI,CAEO,iBAFP,EAGJC,GAHI,CAGApB,GAHA,EAIJqB,MAJI,CAIG,CACPpB,OAAO,CAAPA,OADO,CAEPC,WAAW,CAAEA,WAAW,GAAK,oCAFtB,CAJH,CA9BmB,SAuCzBG,mBAAmB,GACnBC,SAAS,CAAC,CACTU,KAAK,CAAE,SADE,CAETf,OAAO,CAAE,eAFA,CAAD,CAAT,CAxCyB,4FA8CzBqB,OAAO,CAACC,GAAR,cACAjB,SAAS,CAAC,CACTU,KAAK,CAAE,OADE,CAETf,OAAO,CAAE,sBAFA,CAAD,CAAT,CA/CyB,KAmDnB,IAAIgB,CAAAA,KAAJ,aAnDmB,uEAAH,kBAAXnB,CAAAA,WAAW,4CAAjB","sourcesContent":["import validate from 'validate.js'\nimport firebase from 'firebase/app'\nimport 'firebase/firestore'\nimport { useTEPopupsFunctions } from 'react-tec'\n\ninterface Data {\n\tuid: string\n\tmessage: string\n\tshowMessage: string\n\tpopupFunctions: useTEPopupsFunctions\n}\nexport const saveMessage = async (data: Data) => {\n\tconst { uid, message, showMessage, popupFunctions } = data\n\tconst { showNetworkActivity, hideNetworkActivity, showAlert } = popupFunctions\n\n\tconst validatorConstraints: { [key: string]: any } = {\n\t\tmessage: {\n\t\t\tpresence: {\n\t\t\t\tallowEmpty: false,\n\t\t\t},\n\t\t},\n\t\tshowMessage: {\n\t\t\tpresence: {\n\t\t\t\tallowEmpty: false,\n\t\t\t},\n\t\t},\n\t}\n\tconst validationResponse = validate(data, validatorConstraints)\n\tif (validationResponse) {\n\t\tconst valuesArray: any[][] = Object.values(validationResponse)\n\t\tconst firstError: any[] = valuesArray[0]\n\t\tconst firstErrorMessage: string = firstError[0]\n\t\tshowAlert({\n\t\t\ttitle: 'Error',\n\t\t\tmessage: firstErrorMessage,\n\t\t})\n\t\tthrow new Error(firstErrorMessage)\n\t}\n\n\ttry {\n\t\tshowNetworkActivity('Saving Message...')\n\t\tawait firebase\n\t\t\t.firestore()\n\t\t\t.collection('WeddingMessages')\n\t\t\t.doc(uid)\n\t\t\t.update({\n\t\t\t\tmessage,\n\t\t\t\tshowMessage: showMessage === 'Displayed publicly on the website.',\n\t\t\t})\n\n\t\thideNetworkActivity()\n\t\tshowAlert({\n\t\t\ttitle: 'Success',\n\t\t\tmessage: 'Message saved',\n\t\t})\n\t\treturn\n\t} catch (e) {\n\t\tconsole.log(e)\n\t\tshowAlert({\n\t\t\ttitle: 'Error',\n\t\t\tmessage: 'Error saving message',\n\t\t})\n\t\tthrow new Error(e)\n\t}\n}\n"]},"metadata":{},"sourceType":"module"}